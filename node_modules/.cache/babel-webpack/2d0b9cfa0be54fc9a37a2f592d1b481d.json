{"ast":null,"code":"import _asyncToGenerator from \"/Users/avinavshrestha/Desktop/INKU/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { EventEmitter, VERSION } from '@angular/core';\nimport { ResultPopupComponent } from './result-popup/result-popup.component';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/material/dialog\";\nimport * as i2 from \"src/app/services/tracker/tracker.service\";\nimport * as i3 from \"@angular/material/form-field\";\nimport * as i4 from \"@angular/material/toolbar\";\nimport * as i5 from \"@angular/material/input\";\nimport * as i6 from \"@angular/forms\";\nimport * as i7 from \"@angular/material/button\";\nimport * as i8 from \"@angular/common\";\nimport * as i9 from \"@angular/router\";\nconst _c0 = [\"fileInput\"];\nconst _c1 = [\"previewImg\"];\n\nfunction DetectDiseaseComponent_div_18_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 15);\n    i0.ɵɵelementStart(1, \"button\", 16);\n    i0.ɵɵlistener(\"click\", function DetectDiseaseComponent_div_18_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r4);\n      const ctx_r3 = i0.ɵɵnextContext();\n      return ctx_r3.predictEvt.emit();\n    });\n    i0.ɵɵtext(2, \" Predict \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n}\n\nconst _c2 = function () {\n  return [\"/appointments\"];\n};\n\nexport class DetectDiseaseComponent {\n  constructor(dialog, trackerService) {\n    this.dialog = dialog;\n    this.trackerService = trackerService;\n    this.name = 'Angular ' + VERSION.major; //fileAttr is the name of the file to be displayed\n\n    this.fileAttr = 'Choose File'; //creating an instance of predictEvt event emitter - continued in ngAfterViewInit()\n\n    this.predictEvt = new EventEmitter();\n  }\n\n  ngOnInit() {\n    //loading model on init\n    this.classifier = ml5.imageClassifier('assets/model/skin-diseases/' + 'model.json');\n  } //called when input is changed - ie. an image is uploaded\n  //imgFile is the $event passed from the html file\n\n\n  uploadFileEvt(imgFile) {\n    //if the image exists\n    if (imgFile.target.files && imgFile.target.files[0]) {\n      this.fileAttr = ''; //appending the name of the file to fileAttr for display\n\n      Array.from(imgFile.target.files).forEach(file => {\n        this.fileAttr += file.name;\n      }); // HTML5 FileReader API\n\n      let reader = new FileReader();\n\n      reader.onload = e => {\n        let image = new Image();\n        image.src = e.target.result; //image reader onload\n\n        image.onload = rs => {\n          let imgBase64Path = e.target.result;\n          this.dataimage = imgBase64Path;\n        };\n      }; //reading as dataURL - to be called after creating a reader\n\n\n      reader.readAsDataURL(imgFile.target.files[0]); // Reset if duplicate image uploaded again\n\n      this.fileInput.nativeElement.value = '';\n    } //if image not found\n    else {\n        this.fileAttr = 'Choose File';\n      }\n  }\n\n  ngAfterViewInit() {\n    var _this = this;\n\n    //emitting the prdictEvt event\n    this.predictEvt.emit(); //subscribing to the changes produced - button click in this case\n\n    this.predictEvt.subscribe( /*#__PURE__*/_asyncToGenerator(function* () {\n      //ml5 function to classify the image - takes the image element and a callback function\n      let dialogRef = _this.dialog.open(ResultPopupComponent, {\n        data: null\n      });\n\n      yield _this.classifier.classify(_this.previewImg.nativeElement, (error, results) => {\n        if (error) {\n          console.error(error);\n          return;\n        } //setting the values to be transferred to the dialog\n\n\n        _this.confidenceOnDisease = (results[0].confidence * 100).toFixed(2);\n        _this.labelOfDisease = results[0].label; //if dialog reference exists, update the predictionData element which is present in the popup\n\n        if (dialogRef && dialogRef.componentInstance) {\n          dialogRef.componentInstance.predictionData = {\n            disease: _this.labelOfDisease.toUpperCase(),\n            confidence: _this.confidenceOnDisease\n          };\n        }\n\n        dialogRef.afterClosed().subscribe(result => {\n          if (result) {\n            _this.trackerService.addingDisease(_this.labelOfDisease, _this.confidenceOnDisease);\n          }\n        });\n      });\n    }), err => console.error(err)); //log errors if any\n  }\n\n}\n\nDetectDiseaseComponent.ɵfac = function DetectDiseaseComponent_Factory(t) {\n  return new (t || DetectDiseaseComponent)(i0.ɵɵdirectiveInject(i1.MatDialog), i0.ɵɵdirectiveInject(i2.TrackerService));\n};\n\nDetectDiseaseComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: DetectDiseaseComponent,\n  selectors: [[\"app-detect-disease\"]],\n  viewQuery: function DetectDiseaseComponent_Query(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵviewQuery(_c0, 5);\n      i0.ɵɵviewQuery(_c1, 5);\n    }\n\n    if (rf & 2) {\n      let _t;\n\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.fileInput = _t.first);\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.previewImg = _t.first);\n    }\n  },\n  decls: 23,\n  vars: 5,\n  consts: [[1, \"upload_image\"], [1, \"card\"], [1, \"heading\"], [1, \"card-body\", \"d-flex\", \"justify-content-center\"], [\"matInput\", \"\", \"readonly\", \"\", 3, \"ngModel\", \"ngModelChange\"], [\"mat-flat-button\", \"\"], [\"type\", \"file\", \"id\", \"uploadFile\", \"name\", \"uploadFile\", \"accept\", \"image/*\", 3, \"change\"], [\"fileInput\", \"\"], [1, \"card-footer\"], [3, \"src\"], [\"previewImg\", \"\"], [\"class\", \"predict-btn-div\", 4, \"ngIf\"], [1, \"alert-customer\"], [\"href\", \"#\", \"routerLinkActive\", \"router-link-active\", 1, \"btn\", 3, \"routerLink\"], [1, \"fas\", \"fa-chevron-right\"], [1, \"predict-btn-div\"], [\"mat-flat-button\", \"\", \"color\", \"primary\", 3, \"click\"]],\n  template: function DetectDiseaseComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"section\", 0);\n      i0.ɵɵelementStart(1, \"div\", 1);\n      i0.ɵɵelementStart(2, \"h1\", 2);\n      i0.ɵɵtext(3, \"Detect \");\n      i0.ɵɵelementStart(4, \"span\");\n      i0.ɵɵtext(5, \"Diseases\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(6, \"div\", 3);\n      i0.ɵɵelementStart(7, \"mat-form-field\");\n      i0.ɵɵelementStart(8, \"div\");\n      i0.ɵɵelementStart(9, \"mat-toolbar\");\n      i0.ɵɵelementStart(10, \"input\", 4);\n      i0.ɵɵlistener(\"ngModelChange\", function DetectDiseaseComponent_Template_input_ngModelChange_10_listener($event) {\n        return ctx.fileAttr = $event;\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(11, \"button\", 5);\n      i0.ɵɵtext(12, \"Browse File\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(13, \"input\", 6, 7);\n      i0.ɵɵlistener(\"change\", function DetectDiseaseComponent_Template_input_change_13_listener($event) {\n        return ctx.uploadFileEvt($event);\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(15, \"div\", 8);\n      i0.ɵɵelement(16, \"img\", 9, 10);\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(18, DetectDiseaseComponent_div_18_Template, 3, 0, \"div\", 11);\n      i0.ɵɵelementStart(19, \"div\", 12);\n      i0.ɵɵelementStart(20, \"a\", 13);\n      i0.ɵɵtext(21, \" See a Doctor \");\n      i0.ɵɵelement(22, \"span\", 14);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(10);\n      i0.ɵɵproperty(\"ngModel\", ctx.fileAttr);\n      i0.ɵɵadvance(6);\n      i0.ɵɵpropertyInterpolate(\"src\", ctx.dataimage, i0.ɵɵsanitizeUrl);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", ctx.dataimage);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(4, _c2));\n    }\n  },\n  directives: [i3.MatFormField, i4.MatToolbar, i5.MatInput, i6.DefaultValueAccessor, i6.NgControlStatus, i6.NgModel, i7.MatButton, i8.NgIf, i9.RouterLinkWithHref, i9.RouterLinkActive],\n  styles: [\".alert-customer[_ngcontent-%COMP%]{\\n  display: flex;\\n  justify-content: flex-end;\\n  align-items: flex-end;\\n  padding: 15px;\\n  margin: 15px;\\n}\\n.btn[_ngcontent-%COMP%] {\\n  display: inline-block;\\n  margin-top: 1rem;\\n  padding: 0.5rem;\\n  padding-left: 1rem;\\n  border: 0.2rem solid #0288d1;\\n  border-radius: 0.5rem;\\n  box-shadow: 0.5rem 0.5rem 0 rgba(31, 22, 160, 0.2);\\n  color: #0288d1;\\n  cursor: pointer;\\n  font-size: 1.7rem;\\n  background: #fff;\\n}\\n.btn[_ngcontent-%COMP%]   span[_ngcontent-%COMP%] {\\n  padding: 0.7rem 1rem;\\n  border-radius: 0.5rem;\\n  background: #0288d1;\\n  color: #fff;\\n  margin-left: 0.5rem;\\n}\\n.btn[_ngcontent-%COMP%]:hover {\\n  background: #0288d1;\\n  color: #fff;\\n}\\n.btn[_ngcontent-%COMP%]:hover   span[_ngcontent-%COMP%] {\\n  color: #0288d1;\\n  background: #fff;\\n  margin-left: 1rem;\\n}\\n.mat-form-field[_ngcontent-%COMP%] {\\n  margin: 40px 0;\\n}\\n.mat-toolbar-single-row[_ngcontent-%COMP%] {\\n  height: auto !important;\\n  background: transparent;\\n}\\n.mat-toolbar-single-row[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] {\\n  width: 200px;\\n  background-color: #6794ef;\\n  color: #fff;\\n}\\n.mat-form-field[_ngcontent-%COMP%] {\\n  width: 80%;\\n}\\n#uploadFile[_ngcontent-%COMP%] {\\n  top: 0px;\\n  left: 0px;\\n  width: 100%;\\n  z-index: 9;\\n  opacity: 0;\\n  height: 100%;\\n  cursor: pointer;\\n  position: absolute;\\n}\\n.card-footer[_ngcontent-%COMP%] {\\n  display: flex;\\n  justify-content: center;\\n}\\n.card-footer[_ngcontent-%COMP%]   img[_ngcontent-%COMP%] {\\n  max-width: 50%;\\n  width: 50%;\\n}\\n.predict-btn-div[_ngcontent-%COMP%] {\\n  display: flex;\\n  justify-content: center;\\n  margin-top: 20px;\\n}\\n.top-heading[_ngcontent-%COMP%] {\\n  font-size: 2rem;\\n  text-align: center;\\n  margin-top: 1rem;\\n}\\n.heading[_ngcontent-%COMP%] {\\n  text-align: center;\\n  padding: 2rem;\\n  padding-bottom: 2rem;\\n  text-shadow: 0.4rem 0.4rem 0 rgba(0, 0, 0, 0.2);\\n  text-transform: uppercase;\\n  color: #444;\\n  font-size: 3rem;\\n  font-weight: bold;\\n  letter-spacing: 0.4rem;\\n}\\n.heading[_ngcontent-%COMP%]   span[_ngcontent-%COMP%] {\\n  text-transform: uppercase;\\n  color: #0288d1;\\n}\\n@media (max-width: 1024px) {\\n  .card-footer[_ngcontent-%COMP%]   img[_ngcontent-%COMP%] {\\n    max-width: 95%;\\n    width: 95%;\\n  }\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRldGVjdC1kaXNlYXNlLmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSxhQUFhO0VBQ2IseUJBQXlCO0VBQ3pCLHFCQUFxQjtFQUNyQixhQUFhO0VBQ2IsWUFBWTtBQUNkO0FBQ0E7RUFDRSxxQkFBcUI7RUFDckIsZ0JBQWdCO0VBQ2hCLGVBQWU7RUFDZixrQkFBa0I7RUFDbEIsNEJBQTRCO0VBQzVCLHFCQUFxQjtFQUNyQixrREFBa0Q7RUFDbEQsY0FBYztFQUNkLGVBQWU7RUFDZixpQkFBaUI7RUFDakIsZ0JBQWdCO0FBQ2xCO0FBRUE7RUFDRSxvQkFBb0I7RUFDcEIscUJBQXFCO0VBQ3JCLG1CQUFtQjtFQUNuQixXQUFXO0VBQ1gsbUJBQW1CO0FBQ3JCO0FBRUE7RUFDRSxtQkFBbUI7RUFDbkIsV0FBVztBQUNiO0FBRUE7RUFDRSxjQUFjO0VBQ2QsZ0JBQWdCO0VBQ2hCLGlCQUFpQjtBQUNuQjtBQUVBO0VBQ0UsY0FBYztBQUNoQjtBQUVBO0VBQ0UsdUJBQXVCO0VBQ3ZCLHVCQUF1QjtBQUN6QjtBQUVBO0VBQ0UsWUFBWTtFQUNaLHlCQUF5QjtFQUN6QixXQUFXO0FBQ2I7QUFFQTtFQUNFLFVBQVU7QUFDWjtBQUVBO0VBQ0UsUUFBUTtFQUNSLFNBQVM7RUFDVCxXQUFXO0VBQ1gsVUFBVTtFQUNWLFVBQVU7RUFDVixZQUFZO0VBQ1osZUFBZTtFQUNmLGtCQUFrQjtBQUNwQjtBQUVBO0VBQ0UsYUFBYTtFQUNiLHVCQUF1QjtBQUN6QjtBQUNBO0VBQ0UsY0FBYztFQUNkLFVBQVU7QUFDWjtBQUNBO0VBQ0UsYUFBYTtFQUNiLHVCQUF1QjtFQUN2QixnQkFBZ0I7QUFDbEI7QUFDQTtFQUNFLGVBQWU7RUFDZixrQkFBa0I7RUFDbEIsZ0JBQWdCO0FBQ2xCO0FBQ0E7RUFDRSxrQkFBa0I7RUFDbEIsYUFBYTtFQUNiLG9CQUFvQjtFQUNwQiwrQ0FBK0M7RUFDL0MseUJBQXlCO0VBQ3pCLFdBQVc7RUFDWCxlQUFlO0VBQ2YsaUJBQWlCO0VBQ2pCLHNCQUFzQjtBQUN4QjtBQUVBO0VBQ0UseUJBQXlCO0VBQ3pCLGNBQWM7QUFDaEI7QUFDQTtFQUNFO0lBQ0UsY0FBYztJQUNkLFVBQVU7RUFDWjtBQUNGIiwiZmlsZSI6ImRldGVjdC1kaXNlYXNlLmNvbXBvbmVudC5jc3MiLCJzb3VyY2VzQ29udGVudCI6WyIuYWxlcnQtY3VzdG9tZXJ7XG4gIGRpc3BsYXk6IGZsZXg7XG4gIGp1c3RpZnktY29udGVudDogZmxleC1lbmQ7XG4gIGFsaWduLWl0ZW1zOiBmbGV4LWVuZDtcbiAgcGFkZGluZzogMTVweDtcbiAgbWFyZ2luOiAxNXB4O1xufVxuLmJ0biB7XG4gIGRpc3BsYXk6IGlubGluZS1ibG9jaztcbiAgbWFyZ2luLXRvcDogMXJlbTtcbiAgcGFkZGluZzogMC41cmVtO1xuICBwYWRkaW5nLWxlZnQ6IDFyZW07XG4gIGJvcmRlcjogMC4ycmVtIHNvbGlkICMwMjg4ZDE7XG4gIGJvcmRlci1yYWRpdXM6IDAuNXJlbTtcbiAgYm94LXNoYWRvdzogMC41cmVtIDAuNXJlbSAwIHJnYmEoMzEsIDIyLCAxNjAsIDAuMik7XG4gIGNvbG9yOiAjMDI4OGQxO1xuICBjdXJzb3I6IHBvaW50ZXI7XG4gIGZvbnQtc2l6ZTogMS43cmVtO1xuICBiYWNrZ3JvdW5kOiAjZmZmO1xufVxuXG4uYnRuIHNwYW4ge1xuICBwYWRkaW5nOiAwLjdyZW0gMXJlbTtcbiAgYm9yZGVyLXJhZGl1czogMC41cmVtO1xuICBiYWNrZ3JvdW5kOiAjMDI4OGQxO1xuICBjb2xvcjogI2ZmZjtcbiAgbWFyZ2luLWxlZnQ6IDAuNXJlbTtcbn1cblxuLmJ0bjpob3ZlciB7XG4gIGJhY2tncm91bmQ6ICMwMjg4ZDE7XG4gIGNvbG9yOiAjZmZmO1xufVxuXG4uYnRuOmhvdmVyIHNwYW4ge1xuICBjb2xvcjogIzAyODhkMTtcbiAgYmFja2dyb3VuZDogI2ZmZjtcbiAgbWFyZ2luLWxlZnQ6IDFyZW07XG59XG5cbi5tYXQtZm9ybS1maWVsZCB7XG4gIG1hcmdpbjogNDBweCAwO1xufVxuXG4ubWF0LXRvb2xiYXItc2luZ2xlLXJvdyB7XG4gIGhlaWdodDogYXV0byAhaW1wb3J0YW50O1xuICBiYWNrZ3JvdW5kOiB0cmFuc3BhcmVudDtcbn1cblxuLm1hdC10b29sYmFyLXNpbmdsZS1yb3cgYnV0dG9uIHtcbiAgd2lkdGg6IDIwMHB4O1xuICBiYWNrZ3JvdW5kLWNvbG9yOiAjNjc5NGVmO1xuICBjb2xvcjogI2ZmZjtcbn1cblxuLm1hdC1mb3JtLWZpZWxkIHtcbiAgd2lkdGg6IDgwJTtcbn1cblxuI3VwbG9hZEZpbGUge1xuICB0b3A6IDBweDtcbiAgbGVmdDogMHB4O1xuICB3aWR0aDogMTAwJTtcbiAgei1pbmRleDogOTtcbiAgb3BhY2l0eTogMDtcbiAgaGVpZ2h0OiAxMDAlO1xuICBjdXJzb3I6IHBvaW50ZXI7XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbn1cblxuLmNhcmQtZm9vdGVyIHtcbiAgZGlzcGxheTogZmxleDtcbiAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG59XG4uY2FyZC1mb290ZXIgaW1nIHtcbiAgbWF4LXdpZHRoOiA1MCU7XG4gIHdpZHRoOiA1MCU7XG59XG4ucHJlZGljdC1idG4tZGl2IHtcbiAgZGlzcGxheTogZmxleDtcbiAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG4gIG1hcmdpbi10b3A6IDIwcHg7XG59XG4udG9wLWhlYWRpbmcge1xuICBmb250LXNpemU6IDJyZW07XG4gIHRleHQtYWxpZ246IGNlbnRlcjtcbiAgbWFyZ2luLXRvcDogMXJlbTtcbn1cbi5oZWFkaW5nIHtcbiAgdGV4dC1hbGlnbjogY2VudGVyO1xuICBwYWRkaW5nOiAycmVtO1xuICBwYWRkaW5nLWJvdHRvbTogMnJlbTtcbiAgdGV4dC1zaGFkb3c6IDAuNHJlbSAwLjRyZW0gMCByZ2JhKDAsIDAsIDAsIDAuMik7XG4gIHRleHQtdHJhbnNmb3JtOiB1cHBlcmNhc2U7XG4gIGNvbG9yOiAjNDQ0O1xuICBmb250LXNpemU6IDNyZW07XG4gIGZvbnQtd2VpZ2h0OiBib2xkO1xuICBsZXR0ZXItc3BhY2luZzogMC40cmVtO1xufVxuXG4uaGVhZGluZyBzcGFuIHtcbiAgdGV4dC10cmFuc2Zvcm06IHVwcGVyY2FzZTtcbiAgY29sb3I6ICMwMjg4ZDE7XG59XG5AbWVkaWEgKG1heC13aWR0aDogMTAyNHB4KSB7XG4gIC5jYXJkLWZvb3RlciBpbWcge1xuICAgIG1heC13aWR0aDogOTUlO1xuICAgIHdpZHRoOiA5NSU7XG4gIH1cbn1cbiJdfQ== */\"]\n});","map":{"version":3,"sources":["/Users/avinavshrestha/Desktop/INKU/src/app/customComponents/detect-disease/detect-disease.component.ts","/Users/avinavshrestha/Desktop/INKU/src/app/customComponents/detect-disease/detect-disease.component.html"],"names":[],"mappings":"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","sourcesContent":["import { ElementRef, EventEmitter, VERSION, ViewChild } from '@angular/core';\nimport { Component, OnInit } from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\nimport { TrackerService } from 'src/app/services/tracker/tracker.service';\nimport { ResultPopupComponent } from './result-popup/result-popup.component';\n\ndeclare const ml5: any;\n\n@Component({\n  selector: 'app-detect-disease',\n  templateUrl: './detect-disease.component.html',\n  styleUrls: ['./detect-disease.component.css'],\n})\nexport class DetectDiseaseComponent implements OnInit {\n  //event emitter to predict results\n  public predictEvt!: EventEmitter<void>;\n\n  //classifier varaible that loads the model\n  classifier: any;\n\n  //confidence and label of the prediction\n  confidenceOnDisease: any;\n  labelOfDisease: any;\n\n  constructor(\n    public dialog: MatDialog,\n    private trackerService: TrackerService\n  ) {\n    //creating an instance of predictEvt event emitter - continued in ngAfterViewInit()\n    this.predictEvt = new EventEmitter<void>();\n  }\n\n  ngOnInit(): void {\n    //loading model on init\n    this.classifier = ml5.imageClassifier(\n      'assets/model/skin-diseases/' + 'model.json'\n    );\n  }\n\n  name = 'Angular ' + VERSION.major;\n  dataimage: any;\n\n  //selecting the HTML input element\n  @ViewChild('fileInput') fileInput!: ElementRef;\n\n  @ViewChild('previewImg') previewImg!: ElementRef;\n\n  //fileAttr is the name of the file to be displayed\n  fileAttr = 'Choose File';\n\n  //called when input is changed - ie. an image is uploaded\n  //imgFile is the $event passed from the html file\n  uploadFileEvt(imgFile: any) {\n    //if the image exists\n    if (imgFile.target.files && imgFile.target.files[0]) {\n      this.fileAttr = '';\n\n      //appending the name of the file to fileAttr for display\n      Array.from(imgFile.target.files).forEach((file: any) => {\n        this.fileAttr += file.name;\n      });\n\n      // HTML5 FileReader API\n      let reader = new FileReader();\n      reader.onload = (e: any) => {\n        let image = new Image();\n        image.src = e.target.result;\n\n        //image reader onload\n        image.onload = (rs) => {\n          let imgBase64Path = e.target.result;\n          this.dataimage = imgBase64Path;\n        };\n      };\n\n      //reading as dataURL - to be called after creating a reader\n      reader.readAsDataURL(imgFile.target.files[0]);\n\n      // Reset if duplicate image uploaded again\n      this.fileInput.nativeElement.value = '';\n    }\n\n    //if image not found\n    else {\n      this.fileAttr = 'Choose File';\n    }\n  }\n\n  ngAfterViewInit() {\n    //emitting the prdictEvt event\n    this.predictEvt.emit();\n\n    //subscribing to the changes produced - button click in this case\n    this.predictEvt.subscribe(async () => {\n        //ml5 function to classify the image - takes the image element and a callback function\n      let dialogRef = this.dialog.open(ResultPopupComponent, {\n        data: null\n      });\n        await this.classifier.classify(this.previewImg.nativeElement, (error: any, results: any) => {\n            if (error) {\n              console.error(error);\n              return;\n            }\n\n            //setting the values to be transferred to the dialog\n            this.confidenceOnDisease = (results[0].confidence * 100).toFixed(2);\n            this.labelOfDisease = results[0].label;\n\n            //if dialog reference exists, update the predictionData element which is present in the popup\n            if(dialogRef && dialogRef.componentInstance){\n              dialogRef.componentInstance.predictionData = {\n                disease: this.labelOfDisease.toUpperCase(),\n                confidence: this.confidenceOnDisease\n              }\n            }\n\n            dialogRef.afterClosed().subscribe((result) => {\n              if (result) {\n                this.trackerService.addingDisease(\n                  this.labelOfDisease,\n                  this.confidenceOnDisease\n                );\n              }\n            });\n          }\n        );\n      },\n      (err: Error) => console.error(err)\n    ); //log errors if any\n  }\n}\n","<section class=\"upload_image\">\n  <div class=\"card\">\n    <h1 class=\"heading\">Detect <span>Diseases</span></h1>\n    <div class=\"card-body d-flex justify-content-center\">\n      <mat-form-field>\n        <div>\n          <mat-toolbar>\n            <!-- Display files names -->\n            <input matInput [(ngModel)]=\"fileAttr\" readonly />\n\n            <!-- Browse Button -->\n            <button mat-flat-button>Browse File</button>\n          </mat-toolbar>\n\n          <!-- Fetch selected filed on change -->\n          <input\n            type=\"file\"\n            #fileInput\n            id=\"uploadFile\"\n            (change)=\"uploadFileEvt($event)\"\n            name=\"uploadFile\"\n            accept=\"image/*\"\n          />\n        </div>\n      </mat-form-field>\n    </div>\n\n    <div class=\"card-footer\">\n      <img src=\"{{ dataimage }}\" #previewImg />\n    </div>\n\n    <div *ngIf=\"dataimage\" class=\"predict-btn-div\">\n      <!--Emitting the event on click-->\n      <button mat-flat-button color=\"primary\" (click)=\"predictEvt.emit()\">\n        Predict\n      </button>\n    </div>\n    <div class=\"alert-customer\">\n      <a\n        href=\"#\"\n        class=\"btn\"\n        [routerLink]=\"['/appointments']\"\n        routerLinkActive=\"router-link-active\"\n      >\n        See a Doctor <span class=\"fas fa-chevron-right\"></span>\n      </a>\n    </div>\n  </div>\n</section>\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}